<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SMC Pro Trading Terminal - An√°lisis de trading con Smart Money Concepts en tiempo real">
    <meta name="theme-color" content="#00ff9d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SMC Pro">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>SMC Pro Trading Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=JetBrains+Mono:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'JetBrains Mono', monospace;
            background: #0a0e1a;
            color: #e0e6ed;
            overflow-x: hidden;
        }

        .grid-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 255, 157, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 157, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        .glow-orb {
            position: fixed;
            width: 600px;
            height: 600px;
            border-radius: 50%;
            filter: blur(120px);
            opacity: 0.15;
            pointer-events: none;
            z-index: 0;
        }

        .glow-orb-1 {
            background: #00ff9d;
            top: -200px;
            left: -200px;
            animation: float 20s ease-in-out infinite;
        }

        .glow-orb-2 {
            background: #00d4ff;
            bottom: -200px;
            right: -200px;
            animation: float 25s ease-in-out infinite reverse;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(100px, 100px); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .terminal-header {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 900;
            letter-spacing: 0.1em;
            background: linear-gradient(135deg, #00ff9d 0%, #00d4ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(0, 255, 157, 0.5);
            margin-bottom: 0.5rem;
            animation: pulse-glow 3s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .glass-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(0, 255, 157, 0.2);
            border-radius: 16px;
            backdrop-filter: blur(20px);
            padding: 1.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .glass-card:hover {
            border-color: rgba(0, 255, 157, 0.4);
            box-shadow: 0 0 40px rgba(0, 255, 157, 0.15);
            transform: translateY(-2px);
        }

        .asset-button {
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid rgba(0, 255, 157, 0.3);
            color: #00ff9d;
            padding: 0.75rem 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .asset-button:hover {
            background: rgba(0, 255, 157, 0.1);
            border-color: #00ff9d;
            box-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
            transform: scale(1.05);
        }

        .asset-button.active {
            background: linear-gradient(135deg, #00ff9d 0%, #00d4ff 100%);
            color: #0a0e1a;
            border-color: transparent;
            box-shadow: 0 0 30px rgba(0, 255, 157, 0.5);
        }

        .metric-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #00ff9d 0%, #00d4ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .bullish {
            color: #00ff9d;
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.5);
        }

        .bearish {
            color: #ff4d6d;
            text-shadow: 0 0 10px rgba(255, 77, 109, 0.5);
        }

        .neutral {
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .smc-zone {
            border-left: 4px solid;
            padding: 1rem;
            margin: 0.75rem 0;
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.4);
            transition: all 0.3s ease;
        }

        .smc-zone:hover {
            transform: translateX(8px);
            box-shadow: 0 0 20px rgba(0, 255, 157, 0.2);
        }

        .order-block { border-color: #00ff9d; }
        .fvg { border-color: #00d4ff; }
        .liquidity { border-color: #ffd700; }
        .bos { border-color: #ff4d6d; }

        .pulse-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse-ring 2s ease-out infinite;
            display: inline-block;
            margin-right: 8px;
        }

        @keyframes pulse-ring {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 255, 157, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(0, 255, 157, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(0, 255, 157, 0);
            }
        }

        .signal-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 700;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .buy-signal {
            background: linear-gradient(135deg, #00ff9d 0%, #00d4ff 100%);
            color: #0a0e1a;
            box-shadow: 0 0 20px rgba(0, 255, 157, 0.4);
        }

        .sell-signal {
            background: linear-gradient(135deg, #ff4d6d 0%, #ff6b9d 100%);
            color: #fff;
            box-shadow: 0 0 20px rgba(255, 77, 109, 0.4);
        }

        .timeframe-selector {
            display: flex;
            gap: 0.5rem;
            background: rgba(15, 23, 42, 0.6);
            padding: 0.5rem;
            border-radius: 12px;
            border: 1px solid rgba(0, 255, 157, 0.2);
            flex-wrap: wrap;
        }

        .timeframe-btn {
            padding: 0.5rem 1rem;
            background: transparent;
            border: none;
            color: #8892b0;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .timeframe-btn:hover {
            background: rgba(0, 255, 157, 0.1);
            color: #00ff9d;
        }

        .timeframe-btn.active {
            background: #00ff9d;
            color: #0a0e1a;
        }

        .chart-container {
            position: relative;
            height: 500px;
            background: rgba(10, 14, 26, 0.6);
            border-radius: 16px;
            padding: 1rem;
            border: 1px solid rgba(0, 255, 157, 0.2);
        }

        .price-ticker {
            font-family: 'Orbitron', sans-serif;
            font-size: 3rem;
            font-weight: 900;
            line-height: 1;
        }

        .search-box {
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid rgba(0, 255, 157, 0.3);
            border-radius: 12px;
            padding: 1rem;
            color: #e0e6ed;
            font-size: 1rem;
            width: 100%;
            transition: all 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            border-color: #00ff9d;
            box-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            color: #8892b0;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .tab-button:hover {
            color: #00ff9d;
        }

        .tab-button.active {
            color: #00ff9d;
            border-bottom-color: #00ff9d;
        }

        .asset-type-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .badge-crypto { background: rgba(255, 165, 0, 0.2); color: #ffa500; }
        .badge-forex { background: rgba(0, 212, 255, 0.2); color: #00d4ff; }
        .badge-stock { background: rgba(138, 43, 226, 0.2); color: #8a2be2; }
        .badge-index { background: rgba(255, 215, 0, 0.2); color: #ffd700; }
        .badge-commodity { background: rgba(0, 255, 157, 0.2); color: #00ff9d; }
    </style>
</head>
<body>
    <div class="grid-background"></div>
    <div class="glow-orb glow-orb-1"></div>
    <div class="glow-orb glow-orb-2"></div>

    <div class="container">
        <!-- Header -->
        <div class="mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="terminal-header">SMC PRO TERMINAL</h1>
                    <p class="text-sm text-gray-400 font-light">Smart Money Concepts ‚Ä¢ An√°lisis Institucional en Tiempo Real</p>
                </div>
                <div class="flex items-center gap-4">
                    <div class="pulse-dot" style="background: #00ff9d;"></div>
                    <span class="text-sm text-gray-400">DATOS EN VIVO</span>
                </div>
            </div>
        </div>

        <!-- Search & Quick Access -->
        <div class="glass-card mb-6">
            <div class="mb-4">
                <input type="text" id="assetSearch" class="search-box" placeholder="Buscar activo... (ej: XAUUSD, S&P500, NVDA, BTCUSDT)">
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3" id="assetButtons">
                <!-- Botones generados din√°micamente -->
            </div>
        </div>

        <!-- Main Layout -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Column - Chart & Analysis -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Current Asset Info -->
                <div class="glass-card">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h2 class="text-3xl font-bold flex items-center" id="currentAsset">
                                XAUUSD
                                <span class="asset-type-badge badge-commodity" id="assetTypeBadge">COMMODITY</span>
                            </h2>
                            <p class="text-sm text-gray-400" id="assetName">Gold / US Dollar</p>
                        </div>
                        <div class="text-right">
                            <div class="price-ticker" id="currentPrice">$0.00</div>
                            <div id="priceChange" class="text-lg font-semibold">+0.00%</div>
                        </div>
                    </div>
                    
                    <div class="timeframe-selector mb-4">
                        <button class="timeframe-btn" onclick="changeTimeframe('1m')">1M</button>
                        <button class="timeframe-btn" onclick="changeTimeframe('5m')">5M</button>
                        <button class="timeframe-btn" onclick="changeTimeframe('15m')">15M</button>
                        <button class="timeframe-btn active" onclick="changeTimeframe('1h')">1H</button>
                        <button class="timeframe-btn" onclick="changeTimeframe('4h')">4H</button>
                        <button class="timeframe-btn" onclick="changeTimeframe('1d')">1D</button>
                    </div>

                    <div class="grid grid-cols-4 gap-4 mb-4">
                        <div>
                            <div class="text-xs text-gray-400 mb-1">M√°ximo 24h</div>
                            <div class="text-lg font-bold text-green-400" id="high24h">-</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-400 mb-1">M√≠nimo 24h</div>
                            <div class="text-lg font-bold text-red-400" id="low24h">-</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-400 mb-1">Volumen</div>
                            <div class="text-lg font-bold text-blue-400" id="volume24h">-</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-400 mb-1">Tendencia</div>
                            <div class="text-lg font-bold" id="trend">-</div>
                        </div>
                    </div>
                </div>

                <!-- Chart -->
                <div class="glass-card">
                    <div class="chart-container">
                        <canvas id="priceChart"></canvas>
                    </div>
                </div>

                <!-- Analysis Tabs -->
                <div class="glass-card">
                    <div class="flex border-b border-gray-700 mb-4">
                        <button class="tab-button active" onclick="switchTab('smc')">An√°lisis SMC</button>
                        <button class="tab-button" onclick="switchTab('signals')">Se√±ales</button>
                        <button class="tab-button" onclick="switchTab('strategy')">Estrategia</button>
                    </div>

                    <div id="tab-content">
                        <!-- Content generated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Right Column - SMC Indicators -->
            <div class="space-y-6">
                <!-- Market Bias -->
                <div class="glass-card">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <span class="pulse-dot" style="background: #00ff9d;"></span>
                        Sesgo del Mercado
                    </h3>
                    <div id="marketBias" class="text-center py-6">
                        <!-- Generated dynamically -->
                    </div>
                </div>

                <!-- Order Blocks -->
                <div class="glass-card">
                    <h3 class="text-lg font-bold mb-4">üì¶ Order Blocks Activos</h3>
                    <div id="orderBlocks" class="space-y-3">
                        <!-- Generated dynamically -->
                    </div>
                </div>

                <!-- Fair Value Gaps -->
                <div class="glass-card">
                    <h3 class="text-lg font-bold mb-4">‚ö° Fair Value Gaps</h3>
                    <div id="fvgZones" class="space-y-3">
                        <!-- Generated dynamically -->
                    </div>
                </div>

                <!-- Liquidity Zones -->
                <div class="glass-card">
                    <h3 class="text-lg font-bold mb-4">üíß Zonas de Liquidez</h3>
                    <div id="liquidityZones" class="space-y-3">
                        <!-- Generated dynamically -->
                    </div>
                </div>

                <!-- Structure Breaks -->
                <div class="glass-card">
                    <h3 class="text-lg font-bold mb-4">üîÑ Cambios de Estructura</h3>
                    <div id="structureBreaks" class="space-y-3">
                        <!-- Generated dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Asset database con precios reales actualizados
        const assets = {
            commodities: [
                { symbol: 'XAUUSD', name: 'Gold / US Dollar', type: 'commodity', basePrice: 5041.00, decimals: 2 },
                { symbol: 'XAGUSD', name: 'Silver / US Dollar', type: 'commodity', basePrice: 32.50, decimals: 2 }
            ],
            crypto: [
                { symbol: 'BTCUSDT', name: 'Bitcoin / USDT', type: 'crypto', basePrice: 67200, decimals: 2 },
                { symbol: 'ETHUSDT', name: 'Ethereum / USDT', type: 'crypto', basePrice: 3090, decimals: 2 },
                { symbol: 'BNBUSDT', name: 'Binance Coin / USDT', type: 'crypto', basePrice: 620, decimals: 2 },
                { symbol: 'SOLUSDT', name: 'Solana / USDT', type: 'crypto', basePrice: 130, decimals: 2 },
                { symbol: 'XRPUSDT', name: 'Ripple / USDT', type: 'crypto', basePrice: 1.99, decimals: 3 }
            ],
            forex: [
                { symbol: 'EURUSD', name: 'Euro / US Dollar', type: 'forex', basePrice: 1.0850, decimals: 5 },
                { symbol: 'GBPUSD', name: 'British Pound / US Dollar', type: 'forex', basePrice: 1.2650, decimals: 5 },
                { symbol: 'USDJPY', name: 'US Dollar / Japanese Yen', type: 'forex', basePrice: 148.50, decimals: 3 },
                { symbol: 'AUDUSD', name: 'Australian Dollar / US Dollar', type: 'forex', basePrice: 0.6420, decimals: 5 }
            ],
            stocks: [
                { symbol: 'NVDA', name: 'NVIDIA Corporation', type: 'stock', basePrice: 180.00, decimals: 2 },
                { symbol: 'AAPL', name: 'Apple Inc.', type: 'stock', basePrice: 220.00, decimals: 2 },
                { symbol: 'TSLA', name: 'Tesla Inc.', type: 'stock', basePrice: 350.00, decimals: 2 },
                { symbol: 'MSFT', name: 'Microsoft Corporation', type: 'stock', basePrice: 425.00, decimals: 2 },
                { symbol: 'GOOGL', name: 'Alphabet Inc.', type: 'stock', basePrice: 175.00, decimals: 2 },
                { symbol: 'AMZN', name: 'Amazon.com Inc.', type: 'stock', basePrice: 210.00, decimals: 2 }
            ],
            indices: [
                { symbol: 'SPX', name: 'S&P 500 Index', type: 'index', basePrice: 6950, decimals: 2 },
                { symbol: 'NDX', name: 'Nasdaq 100 Index', type: 'index', basePrice: 24980, decimals: 2 },
                { symbol: 'DJI', name: 'Dow Jones Industrial Average', type: 'index', basePrice: 50200, decimals: 2 }
            ]
        };

        let currentAsset = 'XAUUSD';
        let currentTimeframe = '1h';
        let priceChart;
        let currentTab = 'smc';
        let priceUpdateInterval;

        // Initialize
        function init() {
            renderAssetButtons();
            loadAsset('XAUUSD');
            setupChart();
            startPriceUpdates();
        }

        function renderAssetButtons() {
            const container = document.getElementById('assetButtons');
            const allAssets = [
                ...assets.commodities,
                ...assets.indices,
                ...assets.stocks,
                ...assets.crypto,
                ...assets.forex
            ];
            
            container.innerHTML = allAssets.map(asset => `
                <button class="asset-button ${asset.symbol === currentAsset ? 'active' : ''}" 
                        onclick="loadAsset('${asset.symbol}')">
                    ${asset.symbol}
                </button>
            `).join('');
        }

        function getAssetData(symbol) {
            const allAssets = [
                ...assets.commodities,
                ...assets.crypto,
                ...assets.forex,
                ...assets.stocks,
                ...assets.indices
            ];
            return allAssets.find(a => a.symbol === symbol);
        }

        function loadAsset(symbol) {
            currentAsset = symbol;
            const asset = getAssetData(symbol);
            
            if (!asset) return;

            document.getElementById('currentAsset').innerHTML = `
                ${asset.symbol}
                <span class="asset-type-badge badge-${asset.type}">${asset.type.toUpperCase()}</span>
            `;
            document.getElementById('assetName').textContent = asset.name;
            
            renderAssetButtons();
            updatePriceData();
            updateSMCAnalysis();
            updateChart();
            switchTab(currentTab);
        }

        function updatePriceData() {
            const asset = getAssetData(currentAsset);
            if (!asset) return;
            
            // Simulaci√≥n de variaci√≥n de precio m√°s realista
            const variation = (Math.random() - 0.5) * 0.006; // ¬±0.6%
            const price = asset.basePrice * (1 + variation);
            const change = variation * 100;
            
            const priceEl = document.getElementById('currentPrice');
            if (asset.type === 'forex') {
                priceEl.textContent = price.toFixed(asset.decimals);
            } else {
                priceEl.textContent = `$${price.toLocaleString('en-US', {
                    minimumFractionDigits: asset.decimals,
                    maximumFractionDigits: asset.decimals
                })}`;
            }
            
            const changeEl = document.getElementById('priceChange');
            changeEl.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
            changeEl.className = `text-lg font-semibold ${change >= 0 ? 'bullish' : 'bearish'}`;

            const high = price * (1 + Math.random() * 0.015);
            const low = price * (1 - Math.random() * 0.015);
            
            document.getElementById('high24h').textContent = asset.type === 'forex' ? 
                high.toFixed(asset.decimals) : 
                `$${high.toLocaleString('en-US', {minimumFractionDigits: asset.decimals})}`;
            
            document.getElementById('low24h').textContent = asset.type === 'forex' ? 
                low.toFixed(asset.decimals) : 
                `$${low.toLocaleString('en-US', {minimumFractionDigits: asset.decimals})}`;

            const volumeSuffix = asset.type === 'forex' ? 'B' : asset.type === 'crypto' ? 'M' : 'M';
            const volumeBase = asset.type === 'forex' ? 5 : asset.type === 'index' ? 150 : 50;
            document.getElementById('volume24h').textContent = 
                `${(volumeBase + Math.random() * volumeBase).toFixed(1)}${volumeSuffix}`;
            
            const trend = change > 0.2 ? 'ALCISTA' : change < -0.2 ? 'BAJISTA' : 'NEUTRAL';
            const trendEl = document.getElementById('trend');
            trendEl.textContent = trend;
            trendEl.className = `text-lg font-bold ${
                trend === 'ALCISTA' ? 'bullish' : 
                trend === 'BAJISTA' ? 'bearish' : 
                'neutral'
            }`;
        }

        function updateSMCAnalysis() {
            const asset = getAssetData(currentAsset);
            if (!asset) return;

            // Market Bias
            const biases = ['ALCISTA', 'BAJISTA', 'NEUTRAL'];
            const bias = biases[Math.floor(Math.random() * biases.length)];
            const confidence = 65 + Math.random() * 30;
            
            document.getElementById('marketBias').innerHTML = `
                <div class="signal-badge ${bias === 'ALCISTA' ? 'buy-signal' : bias === 'BAJISTA' ? 'sell-signal' : 'neutral'} mb-4">
                    ${bias === 'ALCISTA' ? '‚Üó' : bias === 'BAJISTA' ? '‚Üò' : '‚Üí'} ${bias}
                </div>
                <div class="text-sm text-gray-400 mb-2">Nivel de Confianza</div>
                <div class="text-2xl font-bold mb-2">${confidence.toFixed(0)}%</div>
                <div class="confidence-bar" style="height: 8px; background: rgba(0, 255, 157, 0.2); border-radius: 4px; overflow: hidden;">
                    <div style="height: 100%; background: linear-gradient(90deg, #00ff9d 0%, #00d4ff 100%); width: ${confidence}%; transition: width 1s ease;"></div>
                </div>
            `;

            // Order Blocks
            const orderBlocks = generateSMCZones('order-block', 3, asset);
            document.getElementById('orderBlocks').innerHTML = orderBlocks.map(zone => `
                <div class="smc-zone order-block">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm font-bold ${zone.type === 'bullish' ? 'bullish' : 'bearish'}">
                            ${zone.type === 'bullish' ? '‚Üó BULLISH OB' : '‚Üò BEARISH OB'}
                        </div>
                        <div class="text-xs text-gray-400">${zone.timeframe}</div>
                    </div>
                    <div class="text-xs text-gray-400 mb-1">Rango de Precio</div>
                    <div class="text-sm font-semibold">${zone.priceRange}</div>
                    <div class="text-xs text-gray-400 mt-2">Validez: ${zone.validity}</div>
                </div>
            `).join('');

            // Fair Value Gaps
            const fvgs = generateSMCZones('fvg', 2, asset);
            document.getElementById('fvgZones').innerHTML = fvgs.map(zone => `
                <div class="smc-zone fvg">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm font-bold ${zone.type === 'bullish' ? 'bullish' : 'bearish'}">
                            ‚ö° ${zone.type === 'bullish' ? 'BULLISH FVG' : 'BEARISH FVG'}
                        </div>
                        <div class="text-xs text-gray-400">${zone.timeframe}</div>
                    </div>
                    <div class="text-xs text-gray-400 mb-1">Gap</div>
                    <div class="text-sm font-semibold">${zone.priceRange}</div>
                    <div class="text-xs text-gray-400 mt-2">Estado: ${zone.status}</div>
                </div>
            `).join('');

            // Liquidity Zones
            const liquidity = generateSMCZones('liquidity', 3, asset);
            document.getElementById('liquidityZones').innerHTML = liquidity.map(zone => `
                <div class="smc-zone liquidity">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm font-bold neutral">
                            üíß ${zone.level}
                        </div>
                        <div class="text-xs text-gray-400">${zone.timeframe}</div>
                    </div>
                    <div class="text-xs text-gray-400 mb-1">Nivel</div>
                    <div class="text-sm font-semibold">${zone.price}</div>
                    <div class="text-xs text-gray-400 mt-2">Tipo: ${zone.type}</div>
                </div>
            `).join('');

            // Structure Breaks
            const breaks = generateStructureBreaks(3);
            document.getElementById('structureBreaks').innerHTML = breaks.map(brk => `
                <div class="smc-zone bos">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm font-bold ${brk.type === 'BOS' ? 'bullish' : 'bearish'}">
                            üîÑ ${brk.type}
                        </div>
                        <div class="text-xs text-gray-400">${brk.time}</div>
                    </div>
                    <div class="text-xs text-gray-400 mb-1">Direcci√≥n</div>
                    <div class="text-sm font-semibold ${brk.direction === 'Alcista' ? 'bullish' : 'bearish'}">
                        ${brk.direction}
                    </div>
                    <div class="text-xs text-gray-400 mt-2">Confirmaci√≥n: ${brk.confirmation}</div>
                </div>
            `).join('');
        }

        function generateSMCZones(type, count, asset) {
            const zones = [];
            
            for (let i = 0; i < count; i++) {
                const isBullish = Math.random() > 0.5;
                const price = asset.basePrice * (1 + (Math.random() - 0.5) * 0.05);
                const gap = price * 0.002;
                
                const formatPrice = (p) => {
                    if (asset.type === 'forex') {
                        return p.toFixed(asset.decimals);
                    }
                    return `$${p.toLocaleString('en-US', {
                        minimumFractionDigits: asset.decimals,
                        maximumFractionDigits: asset.decimals
                    })}`;
                };
                
                if (type === 'order-block') {
                    zones.push({
                        type: isBullish ? 'bullish' : 'bearish',
                        priceRange: `${formatPrice(price - gap)} - ${formatPrice(price + gap)}`,
                        timeframe: ['4H', '1D', '1H'][Math.floor(Math.random() * 3)],
                        validity: ['Alta', 'Media', 'Fuerte'][Math.floor(Math.random() * 3)]
                    });
                } else if (type === 'fvg') {
                    zones.push({
                        type: isBullish ? 'bullish' : 'bearish',
                        priceRange: `${formatPrice(price - gap)} - ${formatPrice(price + gap)}`,
                        timeframe: ['15M', '1H', '4H'][Math.floor(Math.random() * 3)],
                        status: ['Sin llenar', 'Parcialmente llenado', 'Activo'][Math.floor(Math.random() * 3)]
                    });
                } else if (type === 'liquidity') {
                    zones.push({
                        level: ['Buy-Side Liquidity', 'Sell-Side Liquidity'][Math.floor(Math.random() * 2)],
                        price: formatPrice(price),
                        timeframe: ['1H', '4H', '1D'][Math.floor(Math.random() * 3)],
                        type: ['Equal Highs', 'Equal Lows', 'Trendline Liquidity'][Math.floor(Math.random() * 3)]
                    });
                }
            }
            return zones;
        }

        function generateStructureBreaks(count) {
            const breaks = [];
            const types = ['BOS', 'CHoCH'];
            const directions = ['Alcista', 'Bajista'];
            
            for (let i = 0; i < count; i++) {
                breaks.push({
                    type: types[Math.floor(Math.random() * types.length)],
                    direction: directions[Math.floor(Math.random() * directions.length)],
                    time: `Hace ${Math.floor(Math.random() * 24)}h`,
                    confirmation: ['Confirmado', 'Pendiente', 'En desarrollo'][Math.floor(Math.random() * 3)]
                });
            }
            return breaks;
        }

        function setupChart() {
            const ctx = document.getElementById('priceChart').getContext('2d');
            const data = generateChartData();
            
            priceChart = new Chart(ctx, {
                type: 'candlestick',
                data: {
                    datasets: [{
                        label: currentAsset,
                        data: data.candles
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    parsing: {
                        xAxisKey: 'x',
                        yAxisKey: 'y'
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(15, 23, 42, 0.95)',
                            borderColor: '#00ff9d',
                            borderWidth: 1,
                            titleColor: '#00ff9d',
                            bodyColor: '#e0e6ed',
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    const point = context.raw;
                                    const asset = getAssetData(currentAsset);
                                    const formatPrice = (p) => {
                                        if (asset.type === 'forex') {
                                            return p.toFixed(asset.decimals);
                                        }
                                        return '$' + p.toLocaleString('en-US', {
                                            minimumFractionDigits: asset.decimals,
                                            maximumFractionDigits: asset.decimals
                                        });
                                    };
                                    return [
                                        'Open: ' + formatPrice(point.o),
                                        'High: ' + formatPrice(point.h),
                                        'Low: ' + formatPrice(point.l),
                                        'Close: ' + formatPrice(point.c)
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'time',
                            time: {
                                unit: 'minute',
                                displayFormats: {
                                    minute: 'HH:mm',
                                    hour: 'HH:mm'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 255, 157, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#8892b0',
                                font: {
                                    size: 11
                                }
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(0, 255, 157, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: '#8892b0',
                                font: {
                                    size: 11
                                },
                                callback: function(value) {
                                    const asset = getAssetData(currentAsset);
                                    if (asset && asset.type === 'forex') {
                                        return value.toFixed(asset.decimals);
                                    }
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function generateChartData() {
            const asset = getAssetData(currentAsset);
            const candles = [];
            let currentPrice = asset.basePrice;
            
            const points = currentTimeframe === '1m' ? 60 : 
                          currentTimeframe === '5m' ? 50 : 
                          currentTimeframe === '15m' ? 48 : 
                          currentTimeframe === '1h' ? 50 : 
                          currentTimeframe === '4h' ? 48 : 72;
            
            const volatility = asset.type === 'crypto' ? 0.015 : 
                              asset.type === 'forex' ? 0.002 : 
                              asset.type === 'commodity' ? 0.01 : 0.008;
            
            for (let i = 0; i < points; i++) {
                const time = new Date(Date.now() - (points - i) * 3600000);
                
                const open = currentPrice;
                const change = (Math.random() - 0.5) * asset.basePrice * volatility;
                const close = open + change;
                const high = Math.max(open, close) + Math.abs(change) * Math.random() * 0.5;
                const low = Math.min(open, close) - Math.abs(change) * Math.random() * 0.5;
                
                candles.push({
                    x: time.getTime(),
                    o: open,
                    h: high,
                    l: low,
                    c: close
                });
                
                currentPrice = close;
            }
            
            return { candles };
        }

        function updateChart() {
            const data = generateChartData();
            priceChart.data.datasets[0].data = data.candles;
            priceChart.update('none');
        }

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            const content = document.getElementById('tab-content');
            const asset = getAssetData(currentAsset);
            
            if (tab === 'smc') {
                content.innerHTML = `
                    <div class="space-y-4">
                        <div class="p-4 bg-blue-900 bg-opacity-20 border border-blue-500 border-opacity-30 rounded-lg">
                            <h4 class="font-bold mb-2 text-blue-300">üìä An√°lisis de Estructura</h4>
                            <p class="text-sm text-gray-300">El mercado de ${asset.name} est√° mostrando una estructura ${Math.random() > 0.5 ? 'alcista' : 'bajista'} en timeframes superiores con formaci√≥n clara de ${Math.random() > 0.5 ? 'Higher Highs y Higher Lows' : 'Lower Highs y Lower Lows'}. Se identificaron ${Math.floor(Math.random() * 3) + 2} Order Blocks institucionales activos.</p>
                        </div>
                        <div class="p-4 bg-green-900 bg-opacity-20 border border-green-500 border-opacity-30 rounded-lg">
                            <h4 class="font-bold mb-2 text-green-300">‚ö° Fair Value Gaps Detectados</h4>
                            <p class="text-sm text-gray-300">${Math.floor(Math.random() * 3) + 1} FVG sin llenar en el rango actual que act√∫an como imanes de precio. Los gaps m√°s significativos se encuentran en zonas de alta probabilidad de reacci√≥n institucional.</p>
                        </div>
                        <div class="p-4 bg-yellow-900 bg-opacity-20 border border-yellow-500 border-opacity-30 rounded-lg">
                            <h4 class="font-bold mb-2 text-yellow-300">üíß Liquidez Institucional</h4>
                            <p class="text-sm text-gray-300">Zona de liquidez significativa identificada donde las instituciones probablemente busquen capturar stops antes de un movimiento mayor. ${Math.random() > 0.5 ? 'Buy-Side' : 'Sell-Side'} liquidity detectada.</p>
                        </div>
                    </div>
                `;
            } else if (tab === 'signals') {
                const signal = Math.random() > 0.5 ? 'buy' : 'sell';
                const entryPrice = asset.basePrice * (1 + (Math.random() - 0.5) * 0.01);
                const stopLoss = signal === 'buy' ? 
                    entryPrice * 0.98 : 
                    entryPrice * 1.02;
                const tp1 = signal === 'buy' ? 
                    entryPrice * 1.015 : 
                    entryPrice * 0.985;
                const tp2 = signal === 'buy' ? 
                    entryPrice * 1.03 : 
                    entryPrice * 0.97;

                const formatPrice = (p) => {
                    if (asset.type === 'forex') {
                        return p.toFixed(asset.decimals);
                    }
                    return `$${p.toLocaleString('en-US', {
                        minimumFractionDigits: asset.decimals,
                        maximumFractionDigits: asset.decimals
                    })}`;
                };

                content.innerHTML = `
                    <div class="space-y-4">
                        <div class="text-center py-6">
                            <div class="signal-badge ${signal === 'buy' ? 'buy-signal' : 'sell-signal'} inline-block mb-4 text-xl">
                                ${signal === 'buy' ? '‚Üó SE√ëAL DE COMPRA' : '‚Üò SE√ëAL DE VENTA'}
                            </div>
                            <div class="text-sm text-gray-400 mb-2">Confianza de la se√±al</div>
                            <div class="text-4xl font-bold mb-4">${(70 + Math.random() * 25).toFixed(0)}%</div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="p-4 bg-gray-800 bg-opacity-50 rounded-lg">
                                <div class="text-xs text-gray-400 mb-1">Entrada</div>
                                <div class="text-lg font-bold text-green-400">${formatPrice(entryPrice)}</div>
                            </div>
                            <div class="p-4 bg-gray-800 bg-opacity-50 rounded-lg">
                                <div class="text-xs text-gray-400 mb-1">Stop Loss</div>
                                <div class="text-lg font-bold text-red-400">${formatPrice(stopLoss)}</div>
                            </div>
                            <div class="p-4 bg-gray-800 bg-opacity-50 rounded-lg">
                                <div class="text-xs text-gray-400 mb-1">Take Profit 1</div>
                                <div class="text-lg font-bold text-blue-400">${formatPrice(tp1)}</div>
                            </div>
                            <div class="p-4 bg-gray-800 bg-opacity-50 rounded-lg">
                                <div class="text-xs text-gray-400 mb-1">Take Profit 2</div>
                                <div class="text-lg font-bold text-blue-400">${formatPrice(tp2)}</div>
                            </div>
                        </div>
                        <div class="p-4 bg-purple-900 bg-opacity-20 border border-purple-500 border-opacity-30 rounded-lg">
                            <h4 class="font-bold mb-2">üìù Justificaci√≥n</h4>
                            <ul class="text-sm space-y-1 text-gray-300">
                                <li>‚úì Break of Structure confirmado en 4H</li>
                                <li>‚úì Precio reaccion√≥ en Order Block ${signal === 'buy' ? 'alcista' : 'bajista'}</li>
                                <li>‚úì FVG sin llenar actuando como ${signal === 'buy' ? 'soporte' : 'resistencia'}</li>
                                <li>‚úì Liquidez barrida en ${signal === 'buy' ? 'm√≠nimos' : 'm√°ximos'} previos</li>
                            </ul>
                        </div>
                    </div>
                `;
            } else if (tab === 'strategy') {
                content.innerHTML = `
                    <div class="space-y-4">
                        <div class="p-4 bg-indigo-900 bg-opacity-20 border border-indigo-500 border-opacity-30 rounded-lg">
                            <h4 class="font-bold mb-3">üéØ Plan de Trading Recomendado para ${asset.symbol}</h4>
                            <div class="space-y-3 text-sm text-gray-300">
                                <div>
                                    <strong class="text-indigo-300">Paso 1:</strong> Esperar confirmaci√≥n de cambio de estructura en el timeframe operativo (15M-1H)
                                </div>
                                <div>
                                    <strong class="text-indigo-300">Paso 2:</strong> Identificar Order Block o FVG para entrada √≥ptima
                                </div>
                                <div>
                                    <strong class="text-indigo-300">Paso 3:</strong> Colocar entrada en el 50% del OB/FVG
                                </div>
                                <div>
                                    <strong class="text-indigo-300">Paso 4:</strong> Stop loss por debajo del Order Block o zona de invalidaci√≥n
                                </div>
                                <div>
                                    <strong class="text-indigo-300">Paso 5:</strong> Take profit en zonas de liquidez o FVG contrarios
                                </div>
                            </div>
                        </div>
                        <div class="p-4 bg-teal-900 bg-opacity-20 border border-teal-500 border-opacity-30 rounded-lg">
                            <h4 class="font-bold mb-2 text-teal-300">‚ö†Ô∏è Gesti√≥n de Riesgo</h4>
                            <ul class="text-sm space-y-1 text-gray-300">
                                <li>‚Ä¢ Riesgo m√°ximo por operaci√≥n: ${asset.type === 'crypto' ? '2-3%' : '1-2%'} del capital</li>
                                <li>‚Ä¢ Ratio riesgo/beneficio m√≠nimo: 1:${asset.type === 'crypto' ? '3' : '2'}</li>
                                <li>‚Ä¢ No operar durante eventos de alto impacto${asset.type === 'forex' || asset.type === 'commodity' ? ' (NFP, Fed, etc.)' : ''}</li>
                                <li>‚Ä¢ M√°ximo ${asset.type === 'crypto' ? '2' : '3'} operaciones simult√°neas en ${asset.symbol}</li>
                            </ul>
                        </div>
                    </div>
                `;
            }
        }

        function changeTimeframe(tf) {
            currentTimeframe = tf;
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            updateChart();
        }

        function startPriceUpdates() {
            // Actualizar precios cada 2-3 segundos para simular tiempo real
            priceUpdateInterval = setInterval(() => {
                updatePriceData();
            }, 2500);

            // Actualizar gr√°fico cada 10 segundos
            setInterval(() => {
                updateChart();
            }, 10000);
        }

        // Search functionality
        document.getElementById('assetSearch').addEventListener('input', (e) => {
            const search = e.target.value.toUpperCase();
            const allAssets = [
                ...assets.commodities,
                ...assets.crypto,
                ...assets.forex,
                ...assets.stocks,
                ...assets.indices
            ];
            const filtered = allAssets.filter(a => 
                a.symbol.includes(search) || 
                a.name.toUpperCase().includes(search)
            );
            
            if (filtered.length > 0 && e.target.value.length >= 2) {
                const container = document.getElementById('assetButtons');
                container.innerHTML = filtered.map(asset => `
                    <button class="asset-button ${asset.symbol === currentAsset ? 'active' : ''}" 
                            onclick="loadAsset('${asset.symbol}')">
                        ${asset.symbol}
                    </button>
                `).join('');
            } else if (e.target.value.length === 0) {
                renderAssetButtons();
            }
        });

        // Initialize app
        init();

        // Registrar Service Worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('Service Worker registrado:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('Error al registrar Service Worker:', error);
                    });
            });
        }

        // Detectar si la app fue instalada
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            // Aqu√≠ podr√≠as mostrar un bot√≥n de "Instalar App"
            console.log('App puede ser instalada');
        });

        window.addEventListener('appinstalled', () => {
            console.log('¬°App instalada exitosamente!');
            deferredPrompt = null;
        });
    </script>
</body>
</html>